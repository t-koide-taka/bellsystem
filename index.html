<!DOCTYPE html>
<html lang="ja">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Ë¶ãÁ©ç„ÇÇ„Çä„Ç∑„Éü„É•„É¨„Éº„Çø„Éº</title>
    <script crossorigin src="https://unpkg.com/react@18/umd/react.development.js"></script>
    <script crossorigin src="https://unpkg.com/react-dom@18/umd/react-dom.development.js"></script>
    <script src="https://unpkg.com/@babel/standalone/babel.min.js"></script>
    <script src="https://cdn.tailwindcss.com"></script>
    <style>
        body { 
            font-family: 'Hiragino Sans', 'Hiragino Kaku Gothic ProN', 'Noto Sans JP', 'Yu Gothic', sans-serif; 
            margin: 0;
            padding: 0;
        }
    </style>
</head>
<body>
    <div id="root">
        <div style="padding: 20px; text-align: center;">
            <p>Ë™≠„ÅøËæº„Åø‰∏≠...</p>
        </div>
    </div>

    <script type="text/babel">
        const { useState } = React;

        function EstimateSimulator() {
            // Âü∫Êú¨„Éá„Éº„Çø
            const months = ['7Êúà', '8Êúà', '9Êúà', '10Êúà', '11Êúà', '12Êúà', '1Êúà', '2Êúà', '3Êúà', '4Êúà', '5Êúà', '6Êúà'];
            const businessDays = [22, 20, 20, 22, 18, 20, 19, 18, 21, 21, 18, 22];
            const workingHours = [176, 160, 160, 176, 144, 160, 152, 144, 168, 168, 144, 176];
            
            const prices = {
                'MGR': 120000,
                'SV': 2700,
                'LD': 2380,
                'CM': 2160,
                'SVÊÆãÊ•≠': 2810,
                'LDÊÆãÊ•≠': 2705,
                'CMÊÆãÊ•≠': 2380,
                'Êé°Áî®Ë≤ª': 100000,
                '„Éñ„Éº„ÇπÂà©Áî®Êñô': 45000
            };

            // ÂÖÉ„ÅÆË¶ãÁ©çÈ°ç
            const originalTotal = 155153573;
            const targetReduction = 5000000;
            const originalMonthlyEstimates = [8893013, 8492155, 8751355, 10760473, 9278415, 13629887, 16485559, 18536784, 19942290, 19459082, 11726997, 9197563];

            // Áä∂ÊÖãÁÆ°ÁêÜ
            const [staffPlan, setStaffPlan] = useState({
                'MGR': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1],
                'SV': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1],
                'LD': [3, 3, 3, 3, 3, 4, 5, 6, 6, 6, 4, 3],
                'CM': [14, 14, 14, 17, 16, 22, 27, 34, 32, 31, 21, 14]
            });

            const [requestSeats] = useState([18, 18, 18, 18, 18, 18, 18, 18, 18, 18, 18, 18]);

            // „Éñ„Éº„ÇπÂà©Áî®Êï∞„ÅÆË®≠ÂÆöÔºàÂÆüÈöõ„ÅÆExcel„Éá„Éº„Çø„Åã„ÇâÔºâ
            const [boothCounts, setBoothCounts] = useState([18, 18, 18, 21, 20, 27, 33, 41, 39, 38, 26, 18]);
            const defaultBoothCounts = [18, 18, 18, 21, 20, 27, 33, 41, 39, 38, 26, 18];
            const boothUnitPrice = 45000;

            // ÁπÅÂøôÊúüÊâãÂΩìË®≠ÂÆöÔºàÊúà„Åî„Å®„ÅÆÂÄãÂà•Ë®≠ÂÆöÔºâ
            const [busySeasonAllowances, setBusySeasonAllowances] = useState({
                0: 0,   // 7Êúà
                1: 0,   // 8Êúà
                2: 0,   // 9Êúà
                3: 0,   // 10Êúà
                4: 0,   // 11Êúà
                5: 0,   // 12Êúà
                6: 150, // 1Êúà („Éá„Éï„Ç©„É´„Éà150ÂÜÜ)
                7: 150, // 2Êúà
                8: 150, // 3Êúà
                9: 150, // 4Êúà
                10: 150, // 5Êúà
                11: 0   // 6Êúà
            });

            // ÂêÑÊúà„ÅÆÁπÅÂøôÊúüÊâãÂΩìÊôÇÈñìÊï∞ÔºàÂÆüÈöõ„ÅÆExcel„Éá„Éº„Çø„Åã„ÇâÔºâ
            const busySeasonHours = {
                0: 0,    // 7Êúà
                1: 0,    // 8Êúà
                2: 0,    // 9Êúà
                3: 0,    // 10Êúà
                4: 0,    // 11Êúà
                5: 0,    // 12Êúà
                6: 4543, // 1Êúà
                7: 5395, // 2Êúà
                8: 6932, // 3Êúà
                9: 6759, // 4Êúà
                10: 3984, // 5Êúà
                11: 0    // 6Êúà
            };

            // ÊúàÂà•Ë¶ãÁ©çÈ°çË®àÁÆó
            const calculateMonthlyEstimate = (monthIndex) => {
                const baselineAmount = originalMonthlyEstimates[monthIndex];
                const baselineStaff = {
                    'MGR': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1],
                    'SV': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1],
                    'LD': [3, 3, 3, 3, 3, 4, 5, 6, 6, 6, 4, 3],
                    'CM': [14, 14, 14, 17, 16, 22, 27, 34, 32, 31, 21, 14]
                };
                const baselineSeats = 18;
                const baselineBoothCount = defaultBoothCounts[monthIndex];
                const baselineBusyAllowance = monthIndex >= 6 && monthIndex <= 10 ? 150 : 0; // ÂÖÉ„ÅÆË®≠ÂÆö
                
                // ÁèæÂú®„ÅÆË®≠ÂÆö„Åß„ÅÆÁπÅÂøôÊúüÊâãÂΩì
                const currentBusyAllowance = busySeasonAllowances[monthIndex] || 0;
                
                let difference = 0;
                
                const mgrDiff = staffPlan.MGR[monthIndex] - baselineStaff.MGR[monthIndex];
                difference += mgrDiff * prices.MGR;
                
                const svDiff = staffPlan.SV[monthIndex] - baselineStaff.SV[monthIndex];
                const svBaseCost = prices.SV * workingHours[monthIndex] * 1.1 + 35 * prices['SVÊÆãÊ•≠'];
                difference += svDiff * svBaseCost;
                
                const ldDiff = staffPlan.LD[monthIndex] - baselineStaff.LD[monthIndex];
                const ldBaseCost = prices.LD * workingHours[monthIndex] * 1.1 + 20 * prices['LDÊÆãÊ•≠'];
                difference += ldDiff * ldBaseCost;
                
                const cmDiff = staffPlan.CM[monthIndex] - baselineStaff.CM[monthIndex];
                const cmBaseCost = prices.CM * workingHours[monthIndex] * 1.1 + 5 * prices['CMÊÆãÊ•≠'];
                difference += cmDiff * cmBaseCost;
                
                const seatsDiff = requestSeats[monthIndex] - baselineSeats;
                difference += seatsDiff * 11500; // Ë®≠ÂÇôË≤ª„ÅÆ„Åø
                
                // „Éñ„Éº„ÇπÂà©Áî®ÊñôÂ∑ÆÂàÜÔºà„Éñ„Éº„ÇπÊï∞ √ó Âçò‰æ°„ÅÆÂ∑ÆÂàÜÔºâ
                const boothCountDiff = boothCounts[monthIndex] - baselineBoothCount;
                difference += boothCountDiff * boothUnitPrice;
                
                // ÁπÅÂøôÊúüÊâãÂΩìÂ∑ÆÂàÜÔºàÊôÇÈñìÊï∞ √ó Âçò‰æ°„ÅÆÂ∑ÆÂàÜÔºâ
                const busyHours = busySeasonHours[monthIndex] || 0;
                const busyAllowanceDiff = (currentBusyAllowance - baselineBusyAllowance) * busyHours;
                difference += busyAllowanceDiff;
                
                if (cmDiff > 0) {
                    difference += cmDiff * prices['Êé°Áî®Ë≤ª'];
                }
                
                return Math.round(baselineAmount + difference);
            };

            const calculateTotalEstimate = () => {
                return months.reduce((total, _, index) => total + calculateMonthlyEstimate(index), 0);
            };

            const currentTotal = calculateTotalEstimate();
            const totalReduction = originalTotal - currentTotal;
            const reductionPercentage = (totalReduction / targetReduction * 100).toFixed(1);

            // „Éè„É≥„Éâ„É©„ÉºÈñ¢Êï∞
            const handleStaffChange = (role, monthIndex, value) => {
                const newStaffPlan = { ...staffPlan };
                newStaffPlan[role][monthIndex] = Math.max(0, parseInt(value) || 0);
                setStaffPlan(newStaffPlan);
            };

            const handleBusyAllowanceChange = (monthIndex, value) => {
                setBusySeasonAllowances(prev => ({
                    ...prev,
                    [monthIndex]: Math.max(0, parseInt(value) || 0)
                }));
            };

            // „Éñ„Éº„ÇπÊï∞Â§âÊõ¥„Éè„É≥„Éâ„É©„Éº
            const handleBoothCountChange = (monthIndex, value) => {
                const newBoothCounts = [...boothCounts];
                newBoothCounts[monthIndex] = Math.max(0, parseInt(value) || 0);
                setBoothCounts(newBoothCounts);
            };

            // Êï∞ÂÄ§„Éï„Ç©„Éº„Éû„ÉÉ„Éà
            const formatNumber = (num) => {
                return new Intl.NumberFormat('ja-JP').format(num);
            };

            // „É™„Çπ„ÇØË©ï‰æ°Èñ¢Êï∞
            const getRiskLevel = (rate) => {
                if (rate <= 0) return { level: '„Å™„Åó', color: 'bg-green-100 text-green-800 border-green-200', icon: '‚úÖ' };
                if (rate <= 10) return { level: '‰Ωé', color: 'bg-yellow-100 text-yellow-800 border-yellow-200', icon: '‚ö†Ô∏è' };
                if (rate <= 25) return { level: '‰∏≠', color: 'bg-orange-100 text-orange-800 border-orange-200', icon: '‚ö°' };
                return { level: 'È´ò', color: 'bg-red-100 text-red-800 border-red-200', icon: 'üö®' };
            };

            const getRiskContent = (role, rate) => {
                if (rate <= 0) return ['„É™„Çπ„ÇØ„Å™„Åó - ÈÅ©Ê≠£„Å™‰∫∫Âì°ÈÖçÁΩÆ„Åß„Åô'];
                
                const riskMap = {
                    'MGR': [
                        '‚Ä¢ Êà¶Áï•Á≠ñÂÆö„ÉªÊñπÈáùÊ±∫ÂÆö„ÅÆÈÅÖÂª∂',
                        '‚Ä¢ KPIÁÆ°ÁêÜ„ÉªÈÄ≤ÊçóÁ¢∫Ë™ç„ÅÆ‰∏çÂÇô',
                        '‚Ä¢ Â•ëÁ¥Ñ‰∫§Ê∏â„ÉªÂñ∂Ê•≠ÂØæÂøú„ÅÆÊîØÈöú',
                        '‚Ä¢ „ÉÅ„Éº„É†Áµ±Âà∂„Éª‰∫∫‰∫ãÁÆ°ÁêÜ„ÅÆ„É™„Çπ„ÇØ'
                    ],
                    'SV': [
                        '‚Ä¢ ÁèæÂ†¥„Éû„Éç„Ç∏„É°„É≥„Éà‰∏çË∂≥',
                        '‚Ä¢ LD„ÉªCMËÇ≤Êàê„Éó„É©„É≥„ÅÆÈÅÖÂª∂',
                        '‚Ä¢ ÈáçË¶ÅÊ°à‰ª∂„ÉªÂÄãÂà•Áõ∏Ë´áÂØæÂøú„ÅÆÊîØÈöú',
                        '‚Ä¢ ÂìÅË≥™ÁÆ°ÁêÜ„ÉªÂ†±ÂëäÊ•≠Âãô„ÅÆ‰∏çÂÇô'
                    ],
                    'LD': [
                        '‚Ä¢ CM„Éï„Ç©„É≠„Éº„ÉªÊåáÂ∞é‰∏çË∂≥',
                        '‚Ä¢ KPIÁÆ°ÁêÜÔºà1on1„ÄÅFBÔºâ„ÅÆÈ†ªÂ∫¶‰Ωé‰∏ã',
                        '‚Ä¢ Êñ∞‰∫∫ËÇ≤Êàê„ÉªOJT„ÅÆË≥™‰Ωé‰∏ã',
                        '‚Ä¢ „Ç®„Çπ„Ç´„É¨„Éº„Ç∑„Éß„É≥ÂØæÂøúÈÅÖÂª∂'
                    ],
                    'CM': [
                        '‚Ä¢ „Ç≥„Éº„É´„Éª„É°„Éº„É´ÂøúÁ≠îÁéá„ÅÆ‰Ωé‰∏ã',
                        '‚Ä¢ È°ßÂÆ¢ÂæÖ„Å°ÊôÇÈñì„ÅÆÂ¢óÂä†',
                        '‚Ä¢ ‰∏ÄÊ¨°ÂØæÂøúÂìÅË≥™„ÅÆ‰Ωé‰∏ã',
                        '‚Ä¢ È°ßÂÆ¢Ê∫ÄË∂≥Â∫¶„Å∏„ÅÆÂΩ±Èüø'
                    ]
                };
                
                return riskMap[role] || ['‚Ä¢ Ê•≠ÂãôÂìÅË≥™„Å∏„ÅÆÂΩ±Èüø'];
            };

            const roleDisplayNames = {
                'MGR': 'MGRÔºù1Âºè',
                'SV': 'SVÔºùB',
                'LD': 'LDÔºùB',
                'CM': 'CMÔºùB'
            };

            return (
                <div className="min-h-screen bg-gradient-to-br from-blue-50 via-white to-purple-50 p-6">
                    <div className="max-w-7xl mx-auto">
                        {/* „Éò„ÉÉ„ÉÄ„Éº */}
                        <div className="bg-white rounded-2xl shadow-xl p-6 mb-6 border border-gray-100">
                            <h1 className="text-3xl font-bold text-gray-800 mb-4">üìä Ë¶ãÁ©ç„ÇÇ„Çä„Ç∑„Éü„É•„É¨„Éº„Çø„Éº</h1>
                            
                            {/* „Çµ„Éû„É™„Éº */}
                            <div className="grid grid-cols-1 md:grid-cols-4 gap-4">
                                <div className="bg-gradient-to-r from-blue-500 to-blue-600 text-white p-4 rounded-xl">
                                    <div className="text-sm opacity-90 mb-1">üìà ÁèæÂú®„ÅÆË¶ãÁ©çÈ°ç</div>
                                    <div className="text-2xl font-bold">¬•{formatNumber(currentTotal)}</div>
                                </div>
                                
                                <div className="bg-gradient-to-r from-green-500 to-green-600 text-white p-4 rounded-xl">
                                    <div className="text-sm opacity-90 mb-1">üìâ ÂâäÊ∏õÈ°ç</div>
                                    <div className="text-2xl font-bold">¬•{formatNumber(totalReduction)}</div>
                                </div>
                                
                                <div className="bg-gradient-to-r from-purple-500 to-purple-600 text-white p-4 rounded-xl">
                                    <div className="text-sm opacity-90 mb-1">üéØ ÁõÆÊ®ôÈÅîÊàêÁéá</div>
                                    <div className="text-2xl font-bold">{reductionPercentage}%</div>
                                </div>
                                
                                <div className="bg-gradient-to-r from-orange-500 to-orange-600 text-white p-4 rounded-xl">
                                    <div className="text-sm opacity-90 mb-1">üéØ ÁõÆÊ®ôÂâäÊ∏õÈ°ç</div>
                                    <div className="text-2xl font-bold">¬•{formatNumber(targetReduction)}</div>
                                </div>
                            </div>
                        </div>

                        {/* ÁπÅÂøôÊúüÊâãÂΩìË®≠ÂÆö */}
                        <div className="bg-white rounded-2xl shadow-xl p-6 mb-6 border border-gray-100">
                            <h2 className="text-2xl font-bold text-gray-800 mb-4">üéØ ÁπÅÂøôÊúüÊâãÂΩìË®≠ÂÆöÔºàÊúàÂà•Ôºâ</h2>
                            
                            {/* ÊúàÂà•Ë®≠ÂÆö„Ç∞„É™„ÉÉ„Éâ */}
                            <div className="grid grid-cols-1 md:grid-cols-3 lg:grid-cols-4 gap-4">
                                {months.map((month, index) => {
                                    const hours = busySeasonHours[index] || 0;
                                    const allowance = busySeasonAllowances[index] || 0;
                                    const totalAmount = hours * allowance;
                                    const isActive = hours > 0;
                                    
                                    return (
                                        <div key={index} className={`p-4 rounded-xl border-2 ${
                                            isActive ? 'bg-orange-50 border-orange-200' : 'bg-gray-50 border-gray-200'
                                        }`}>
                                            <div className="text-center mb-2">
                                                <div className="font-bold text-lg">{month}</div>
                                                {isActive && (
                                                    <div className="text-xs text-gray-600">{formatNumber(hours)}ÊôÇÈñì</div>
                                                )}
                                            </div>
                                            
                                            <div className="space-y-2">
                                                <label className="block text-xs font-semibold text-gray-700">
                                                    Âçò‰æ°ÔºàÂÜÜ/ÊôÇÈñìÔºâ
                                                </label>
                                                <input
                                                    type="number"
                                                    value={allowance}
                                                    onChange={(e) => handleBusyAllowanceChange(index, e.target.value)}
                                                    className="w-full p-2 text-sm border rounded"
                                                    min="0"
                                                    placeholder="0"
                                                    disabled={!isActive}
                                                />
                                                
                                                {isActive && (
                                                    <div className="text-center">
                                                        <div className="text-xs text-gray-600">ÊúàÈ°ç</div>
                                                        <div className="font-bold text-sm text-orange-700">
                                                            ¬•{formatNumber(totalAmount)}
                                                        </div>
                                                    </div>
                                                )}
                                            </div>
                                        </div>
                                    );
                                })}
                            </div>
                            
                            {/* ÂêàË®àË°®Á§∫ */}
                            <div className="mt-4 p-3 bg-blue-50 rounded-lg">
                                <div className="text-sm font-semibold text-gray-700 mb-2">üìä ÁπÅÂøôÊúüÊâãÂΩìÂêàË®à</div>
                                <div className="text-lg font-bold text-blue-700">
                                    Âπ¥ÈñìÂêàË®à: ¬•{formatNumber(
                                        Object.keys(busySeasonHours).reduce((total, monthIndex) => {
                                            const hours = busySeasonHours[monthIndex] || 0;
                                            const allowance = busySeasonAllowances[monthIndex] || 0;
                                            return total + (hours * allowance);
                                        }, 0)
                                    )}
                                </div>
                            </div>
                        </div>

                        {/* ÊúàÂà•Ë©≥Á¥∞„ÉÜ„Éº„Éñ„É´ */}
                        <div className="bg-white rounded-2xl shadow-xl p-6 mb-6 border border-gray-100">
                            <h2 className="text-2xl font-bold text-gray-800 mb-4">ÊúàÂà•Ë¶ãÁ©çË©≥Á¥∞</h2>
                            <div className="overflow-x-auto">
                                <table className="w-full text-sm">
                                    <thead>
                                        <tr className="bg-gray-50">
                                            <th className="text-left p-3 font-semibold border-b">È†ÖÁõÆ</th>
                                            {months.map((month, index) => (
                                                <th key={index} className="text-center p-3 font-semibold border-b min-w-20">{month}</th>
                                            ))}
                                        </tr>
                                    </thead>
                                    <tbody>
                                        <tr>
                                            <td className="p-3 font-medium bg-blue-50">Âñ∂Ê•≠Êó•Êï∞</td>
                                            {businessDays.map((days, index) => (
                                                <td key={index} className="text-center p-3 border-b">{days}</td>
                                            ))}
                                        </tr>
                                        
                                        {/* ÁπÅÂøôÊúüÊâãÂΩìÈÅ©Áî®Áä∂Ê≥Å */}
                                        <tr>
                                            <td className="p-3 font-medium bg-orange-50">ÁπÅÂøôÊúüÊâãÂΩì</td>
                                            {months.map((_, index) => {
                                                const allowance = busySeasonAllowances[index] || 0;
                                                const hours = busySeasonHours[index] || 0;
                                                const totalAmount = hours * allowance;
                                                const isActive = hours > 0;
                                                
                                                return (
                                                    <td key={index} className="text-center p-2 border-b">
                                                        {isActive ? (
                                                            <div className="text-xs">
                                                                <div className={`px-1 py-1 rounded ${
                                                                    allowance > 0 
                                                                        ? 'bg-orange-200 text-orange-800 font-bold' 
                                                                        : 'bg-gray-100 text-gray-500'
                                                                }`}>
                                                                    ¬•{allowance}/h
                                                                </div>
                                                                <div className="text-gray-600 mt-1">
                                                                    ¬•{formatNumber(totalAmount)}
                                                                </div>
                                                            </div>
                                                        ) : (
                                                            <span className="px-2 py-1 rounded text-xs bg-gray-100 text-gray-500">
                                                                -
                                                            </span>
                                                        )}
                                                    </td>
                                                );
                                            })}
                                        
                                        {/* „Éñ„Éº„ÇπÊï∞ */}
                                        <tr>
                                            <td className="p-3 font-medium bg-blue-50">„Éñ„Éº„ÇπÊï∞</td>
                                            {boothCounts.map((count, index) => (
                                                <td key={index} className="text-center p-2 border-b">
                                                    <div className="flex flex-col items-center">
                                                        <input
                                                            type="number"
                                                            value={count}
                                                            onChange={(e) => handleBoothCountChange(index, e.target.value)}
                                                            className="w-12 text-center border rounded px-1 py-1 text-sm"
                                                            min="0"
                                                        />
                                                        <span className="text-xs text-gray-400 mt-1">({defaultBoothCounts[index]}B)</span>
                                                    </div>
                                                </td>
                                            ))}
                                        </tr>
                                        
                                        {/* „Éñ„Éº„ÇπÂà©Áî®Êñô */}
                                        <tr>
                                            <td className="p-3 font-medium bg-blue-50">„Éñ„Éº„ÇπÂà©Áî®Êñô</td>
                                            {boothCounts.map((count, index) => {
                                                const monthlyBoothCost = count * boothUnitPrice;
                                                const baselineBoothCost = defaultBoothCounts[index] * boothUnitPrice;
                                                const boothCostDiff = monthlyBoothCost - baselineBoothCost;
                                                return (
                                                    <td key={index} className="text-center p-2 border-b">
                                                        <div className="text-xs">
                                                            <div className="font-bold">¬•{formatNumber(monthlyBoothCost)}</div>
                                                            {Math.abs(boothCostDiff) > 0 && (
                                                                <div className={`text-xs ${boothCostDiff > 0 ? 'text-red-600' : 'text-green-600'}`}>
                                                                    {boothCostDiff > 0 ? '‚Üë' : '‚Üì'}¬•{formatNumber(Math.abs(boothCostDiff))}
                                                                </div>
                                                            )}
                                                        </div>
                                                    </td>
                                                );
                                            })}
                                        </tr></tr>
                                        
                                        {/* ‰∫∫Âì°Ë®àÁîª */}
                                        {Object.entries(staffPlan).map(([role, counts]) => {
                                            const defaultStaff = {
                                                'MGR': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1],
                                                'SV': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1],
                                                'LD': [3, 3, 3, 3, 3, 4, 5, 6, 6, 6, 4, 3],
                                                'CM': [14, 14, 14, 17, 16, 22, 27, 34, 32, 31, 21, 14]
                                            };
                                            
                                            return (
                                                <tr key={role}>
                                                    <td className="p-3 font-medium bg-yellow-50">{roleDisplayNames[role]}</td>
                                                    {counts.map((count, index) => (
                                                        <td key={index} className="text-center p-2 border-b">
                                                            <div className="flex flex-col items-center">
                                                                <input
                                                                    type="number"
                                                                    value={count}
                                                                    onChange={(e) => handleStaffChange(role, index, e.target.value)}
                                                                    className="w-12 text-center border rounded px-1 py-1 text-sm"
                                                                    min="0"
                                                                />
                                                                <span className="text-xs text-gray-400 mt-1">({defaultStaff[role][index]})</span>
                                                            </div>
                                                        </td>
                                                    ))}
                                                </tr>
                                            );
                                        })}
                                        
                                        {/* ÊúàÂà•Ë¶ãÁ©çÈ°ç */}
                                        <tr className="bg-purple-50">
                                            <td className="p-3 font-bold">ÊúàÂà•Ë¶ãÁ©çÈ°ç</td>
                                            {months.map((_, index) => {
                                                const monthlyAmount = calculateMonthlyEstimate(index);
                                                const originalAmount = originalMonthlyEstimates[index];
                                                const reduction = originalAmount - monthlyAmount;
                                                return (
                                                    <td key={index} className="text-center p-3 border-b">
                                                        <div className="text-sm font-bold">¬•{formatNumber(monthlyAmount)}</div>
                                                        {Math.abs(reduction) > 100 && (
                                                            <div className={`text-xs ${reduction > 0 ? 'text-green-600' : 'text-red-600'}`}>
                                                                {reduction > 0 ? '‚Üì' : '‚Üë'}¬•{formatNumber(Math.abs(reduction))}
                                                            </div>
                                                        )}
                                                    </td>
                                                );
                                            })}
                                        </tr>
                                    </tbody>
                                </table>
                            </div>
                        </div>

                        {/* „É™„Çπ„ÇØË©ï‰æ°„Éú„ÉÉ„ÇØ„Çπ */}
                        <div className="bg-white rounded-2xl shadow-xl p-6 border border-gray-100">
                            <h2 className="text-2xl font-bold text-gray-800 mb-4">‰∫∫Âì°ÂâäÊ∏õ„É™„Çπ„ÇØË©ï‰æ°</h2>
                            <div className="grid grid-cols-1 md:grid-cols-2 gap-6">
                                {Object.entries(staffPlan).map(([role, counts]) => {
                                    const baselineStaff = {
                                        'MGR': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1],
                                        'SV': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1],
                                        'LD': [3, 3, 3, 3, 3, 4, 5, 6, 6, 6, 4, 3],
                                        'CM': [14, 14, 14, 17, 16, 22, 27, 34, 32, 31, 21, 14]
                                    };
                                    
                                    const totalCurrent = counts.reduce((sum, count) => sum + count, 0);
                                    const totalBaseline = baselineStaff[role].reduce((sum, count) => sum + count, 0);
                                    const reductionRate = ((totalBaseline - totalCurrent) / totalBaseline * 100);
                                    
                                    const risk = getRiskLevel(reductionRate);
                                    const riskContent = getRiskContent(role, reductionRate);

                                    return (
                                        <div key={role} className={`border-2 rounded-xl p-4 ${risk.color}`}>
                                            <div className="flex items-center justify-between mb-3">
                                                <div className="flex items-center gap-2">
                                                    <span className="text-lg">{risk.icon}</span>
                                                    <h3 className="font-bold text-lg">{roleDisplayNames[role]}</h3>
                                                </div>
                                                <div className="text-right">
                                                    <div className="text-sm opacity-75">ÂâäÊ∏õÁéá</div>
                                                    <div className="font-bold">{reductionRate > 0 ? `${reductionRate.toFixed(1)}%` : '0%'}</div>
                                                </div>
                                            </div>
                                            
                                            <div className="mb-2">
                                                <div className="text-sm font-semibold mb-1">„É™„Çπ„ÇØ„É¨„Éô„É´: {risk.level}</div>
                                            </div>
                                            
                                            {reductionRate > 0 && (
                                                <div className="text-sm space-y-1">
                                                    <div className="font-semibold">ÊÉ≥ÂÆö„Åï„Çå„ÇãÂΩ±Èüø:</div>
                                                    {riskContent.map((content, index) => (
                                                        <div key={index} className="text-xs">{content}</div>
                                                    ))}
                                                </div>
                                            )}
                                            
                                            <div className="mt-2 text-xs opacity-75">
                                                ÁèæÂú®: {totalCurrent}Âêç / Âü∫Ê∫ñ: {totalBaseline}Âêç
                                            </div>
                                        </div>
                                    );
                                })}
                            </div>
                            
                            {/* Á∑èÂêà„É™„Çπ„ÇØË©ï‰æ° */}
                            <div className="mt-6 p-4 bg-gray-50 rounded-xl">
                                <h3 className="font-bold text-lg mb-2">üéØ Á∑èÂêà„É™„Çπ„ÇØË©ï‰æ°</h3>
                                <div className="text-sm space-y-2">
                                    {(() => {
                                        const totalReductions = Object.entries(staffPlan).map(([role, counts]) => {
                                            const baselineStaff = {
                                                'MGR': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1],
                                                'SV': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1],
                                                'LD': [3, 3, 3, 3, 3, 4, 5, 6, 6, 6, 4, 3],
                                                'CM': [14, 14, 14, 17, 16, 22, 27, 34, 32, 31, 21, 14]
                                            };
                                            const totalCurrent = counts.reduce((sum, count) => sum + count, 0);
                                            const totalBaseline = baselineStaff[role].reduce((sum, count) => sum + count, 0);
                                            return { role, reduction: totalBaseline - totalCurrent };
                                        });
                                        
                                        const hasHighRisk = totalReductions.some(r => (r.reduction / (r.role === 'CM' ? 256 : r.role === 'LD' ? 49 : 12)) > 0.25);
                                        const hasMediumRisk = totalReductions.some(r => (r.reduction / (r.role === 'CM' ? 256 : r.role === 'LD' ? 49 : 12)) > 0.1);
                                        
                                        if (hasHighRisk) {
                                            return (
                                                <div>
                                                    <div className="text-red-700 font-semibold">üö® È´ò„É™„Çπ„ÇØ: „Çµ„Éº„Éì„ÇπÂìÅË≥™„Å∏„ÅÆÈáçÂ§ß„Å™ÂΩ±Èüø„ÅåÊá∏Âøµ„Åï„Çå„Åæ„Åô</div>
                                                    <div className="text-sm">‚Ä¢ È°ßÂÆ¢Ê∫ÄË∂≥Â∫¶‰Ωé‰∏ã„ÄÅSLAÊú™ÈÅîÊàê„ÄÅÂìÅË≥™„ÇØ„É¨„Éº„É†Â¢óÂä†„ÅÆÂèØËÉΩÊÄß</div>
                                                    <div className="text-sm">‚Ä¢ ÊÆµÈöéÁöÑÂâäÊ∏õ„ÇÑ„Éó„É≠„Çª„ÇπÊîπÂñÑ„Å®„ÅÆ‰ΩµÁî®„ÇíÊé®Â•®</div>
                                                </div>
                                            );
                                        }
                                        if (hasMediumRisk) {
                                            return (
                                                <div>
                                                    <div className="text-orange-700 font-semibold">‚ö° ‰∏≠„É™„Çπ„ÇØ: Ê•≠ÂãôÂìÅË≥™„Å∏„ÅÆÂΩ±Èüø„Å´Ê≥®ÊÑè„ÅåÂøÖË¶Å„Åß„Åô</div>
                                                    <div className="text-sm">‚Ä¢ ÂØÜÊé•„Å™„É¢„Éã„Çø„É™„É≥„Ç∞„Å®ÂìÅË≥™ÁÆ°ÁêÜ„ÅÆÂº∑Âåñ„ÅåÂøÖË¶Å</div>
                                                    <div className="text-sm">‚Ä¢ Á†î‰øÆ„ÉªÂäπÁéáÂåñÊñΩÁ≠ñ„Å®„ÅÆ‰∏¶Ë°åÂÆüÊñΩ„ÇíÊé®Â•®</div>
                                                </div>
                                            );
                                        }
                                        return (
                                            <div>
                                                <div className="text-green-700 font-semibold">‚úÖ ‰Ωé„É™„Çπ„ÇØ: ÈÅ©Ê≠£„Å™‰∫∫Âì°ÈÖçÁΩÆÁØÑÂõ≤ÂÜÖ„Åß„Åô</div>
                                                <div className="text-sm">‚Ä¢ „Çµ„Éº„Éì„ÇπÂìÅË≥™„ÇíÁ∂≠ÊåÅ„Åó„Å™„Åå„Çâ„Ç≥„Çπ„ÉàÂâäÊ∏õ„ÅåÂèØËÉΩ</div>
                                            </div>
                                        );
                                    })()}
                                </div>
                            </div>
                        </div>

                        {/* ÂâäÊ∏õÂäπÊûú„É°„ÉÉ„Çª„Éº„Ç∏ */}
                        <div className="mt-6 text-center">
                            <div className={`inline-block px-6 py-3 rounded-full text-white font-bold ${
                                totalReduction >= targetReduction ? 'bg-green-500' : 'bg-orange-500'
                            }`}>
                                {totalReduction >= targetReduction 
                                    ? `üéâ ÁõÆÊ®ôÈÅîÊàêÔºÅ ¬•${formatNumber(totalReduction - targetReduction)}„ÅÆËøΩÂä†ÂâäÊ∏õÂäπÊûú` 
                                    : `ÁõÆÊ®ô„Åæ„Åß ¬•${formatNumber(targetReduction - totalReduction)} „ÅÆÂâäÊ∏õ„ÅåÂøÖË¶Å`
                                }
                            </div>
                        </div>
                    </div>
                </div>
            );
        }

        // React„Ç¢„Éó„É™„Çí„Éû„Ç¶„É≥„Éà
        const rootElement = document.getElementById('root');
        if (rootElement) {
            ReactDOM.render(React.createElement(EstimateSimulator), rootElement);
        }
    </script>
</body>
</html>
