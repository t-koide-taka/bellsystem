<!DOCTYPE html>
<html lang="ja">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>è¦‹ç©ã‚‚ã‚Šã‚·ãƒŸãƒ¥ãƒ¬ãƒ¼ã‚¿ãƒ¼</title>
    <script crossorigin src="https://unpkg.com/react@18/umd/react.development.js"></script>
    <script crossorigin src="https://unpkg.com/react-dom@18/umd/react-dom.development.js"></script>
    <script src="https://unpkg.com/@babel/standalone/babel.min.js"></script>
    <script src="https://cdn.tailwindcss.com"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/jspdf/2.5.1/jspdf.umd.min.js"></script>
    <style>
        body { 
            font-family: 'Hiragino Sans', 'Hiragino Kaku Gothic ProN', 'Noto Sans JP', 'Yu Gothic', sans-serif; 
            margin: 0;
            padding: 0;
        }
    </style>
</head>
<body>
    <div id="root">
        <div style="padding: 20px; text-align: center;">
            <p>èª­ã¿è¾¼ã¿ä¸­...</p>
        </div>
    </div>

    <script type="text/babel">
        const { useState } = React;

        function EstimateSimulator() {
            // åŸºæœ¬ãƒ‡ãƒ¼ã‚¿
            const months = ['7æœˆ', '8æœˆ', '9æœˆ', '10æœˆ', '11æœˆ', '12æœˆ', '1æœˆ', '2æœˆ', '3æœˆ', '4æœˆ', '5æœˆ', '6æœˆ'];
            const businessDays = [22, 20, 20, 22, 18, 20, 19, 18, 21, 21, 18, 22];
            const workingHours = [176, 160, 160, 176, 144, 160, 152, 144, 168, 168, 144, 176];
            
            const prices = {
                'MGR': 120000,
                'SV': 2700,
                'LD': 2380,
                'CM': 2160,
                'SVæ®‹æ¥­': 2810,
                'LDæ®‹æ¥­': 2705,
                'CMæ®‹æ¥­': 2380,
                'æ¡ç”¨è²»': 100000,
                'ãƒ–ãƒ¼ã‚¹åˆ©ç”¨æ–™': 45000
            };

            // å…ƒã®è¦‹ç©é¡
            const originalTotal = 155153573;
            const targetReduction = 5000000;
            const originalMonthlyEstimates = [8893013, 8492155, 8751355, 10760473, 9278415, 13629887, 16485559, 18536784, 19942290, 19459082, 11726997, 9197563];

            // çŠ¶æ…‹ç®¡ç†
            const [staffPlan, setStaffPlan] = useState({
                'MGR': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1],
                'SV': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1],
                'LD': [3, 3, 3, 3, 3, 4, 5, 6, 6, 6, 4, 3],
                'CM': [14, 14, 14, 17, 16, 22, 27, 34, 32, 31, 21, 14]
            });

            const [requestSeats] = useState([18, 18, 18, 18, 18, 18, 18, 18, 18, 18, 18, 18]);

            // ãƒ–ãƒ¼ã‚¹åˆ©ç”¨æ•°ã®è¨­å®šï¼ˆå®Ÿéš›ã®Excelãƒ‡ãƒ¼ã‚¿ã‹ã‚‰ï¼‰
            const [boothCounts, setBoothCounts] = useState([18, 18, 18, 21, 20, 27, 33, 41, 39, 38, 26, 18]);
            const defaultBoothCounts = [18, 18, 18, 21, 20, 27, 33, 41, 39, 38, 26, 18];
            const boothUnitPrice = 45000;

            // ç¹å¿™æœŸæ‰‹å½“è¨­å®šï¼ˆæœˆã”ã¨ã®å€‹åˆ¥è¨­å®šï¼‰
            const [busySeasonAllowances, setBusySeasonAllowances] = useState({
                0: 0,   // 7æœˆ
                1: 0,   // 8æœˆ
                2: 0,   // 9æœˆ
                3: 0,   // 10æœˆ
                4: 0,   // 11æœˆ
                5: 0,   // 12æœˆ
                6: 150, // 1æœˆ (ãƒ‡ãƒ•ã‚©ãƒ«ãƒˆ150å††)
                7: 150, // 2æœˆ
                8: 150, // 3æœˆ
                9: 150, // 4æœˆ
                10: 150, // 5æœˆ
                11: 0   // 6æœˆ
            });

            // å„æœˆã®ç¹å¿™æœŸæ‰‹å½“æ™‚é–“æ•°ï¼ˆå®Ÿéš›ã®Excelãƒ‡ãƒ¼ã‚¿ã‹ã‚‰ï¼‰
            const busySeasonHours = {
                0: 0,    // 7æœˆ
                1: 0,    // 8æœˆ
                2: 0,    // 9æœˆ
                3: 0,    // 10æœˆ
                4: 0,    // 11æœˆ
                5: 0,    // 12æœˆ
                6: 4543, // 1æœˆ
                7: 5395, // 2æœˆ
                8: 6932, // 3æœˆ
                9: 6759, // 4æœˆ
                10: 3984, // 5æœˆ
                11: 0    // 6æœˆ
            };

            // æœˆåˆ¥è¦‹ç©é¡è¨ˆç®—
            const calculateMonthlyEstimate = (monthIndex) => {
                const baselineAmount = originalMonthlyEstimates[monthIndex];
                const baselineStaff = {
                    'MGR': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1],
                    'SV': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1],
                    'LD': [3, 3, 3, 3, 3, 4, 5, 6, 6, 6, 4, 3],
                    'CM': [14, 14, 14, 17, 16, 22, 27, 34, 32, 31, 21, 14]
                };
                const baselineSeats = 18;
                const baselineBoothCount = defaultBoothCounts[monthIndex];
                const baselineBusyAllowance = monthIndex >= 6 && monthIndex <= 10 ? 150 : 0; // å…ƒã®è¨­å®š
                
                // ç¾åœ¨ã®è¨­å®šã§ã®ç¹å¿™æœŸæ‰‹å½“
                const currentBusyAllowance = busySeasonAllowances[monthIndex] || 0;
                
                let difference = 0;
                
                const mgrDiff = staffPlan.MGR[monthIndex] - baselineStaff.MGR[monthIndex];
                difference += mgrDiff * prices.MGR;
                
                const svDiff = staffPlan.SV[monthIndex] - baselineStaff.SV[monthIndex];
                const svBaseCost = prices.SV * workingHours[monthIndex] * 1.1 + 35 * prices['SVæ®‹æ¥­'];
                difference += svDiff * svBaseCost;
                
                const ldDiff = staffPlan.LD[monthIndex] - baselineStaff.LD[monthIndex];
                const ldBaseCost = prices.LD * workingHours[monthIndex] * 1.1 + 20 * prices['LDæ®‹æ¥­'];
                difference += ldDiff * ldBaseCost;
                
                const cmDiff = staffPlan.CM[monthIndex] - baselineStaff.CM[monthIndex];
                const cmBaseCost = prices.CM * workingHours[monthIndex] * 1.1 + 5 * prices['CMæ®‹æ¥­'];
                difference += cmDiff * cmBaseCost;
                
                const seatsDiff = requestSeats[monthIndex] - baselineSeats;
                difference += seatsDiff * 11500; // è¨­å‚™è²»ã®ã¿
                
                // ãƒ–ãƒ¼ã‚¹åˆ©ç”¨æ–™å·®åˆ†ï¼ˆãƒ–ãƒ¼ã‚¹æ•° Ã— å˜ä¾¡ã®å·®åˆ†ï¼‰
                const boothCountDiff = boothCounts[monthIndex] - baselineBoothCount;
                difference += boothCountDiff * boothUnitPrice;
                
                // ç¹å¿™æœŸæ‰‹å½“å·®åˆ†ï¼ˆæ™‚é–“æ•° Ã— å˜ä¾¡ã®å·®åˆ†ï¼‰
                const busyHours = busySeasonHours[monthIndex] || 0;
                const busyAllowanceDiff = (currentBusyAllowance - baselineBusyAllowance) * busyHours;
                difference += busyAllowanceDiff;
                
                if (cmDiff > 0) {
                    difference += cmDiff * prices['æ¡ç”¨è²»'];
                }
                
                return Math.round(baselineAmount + difference);
            };

            const calculateTotalEstimate = () => {
                return months.reduce((total, _, index) => total + calculateMonthlyEstimate(index), 0);
            };

            const currentTotal = calculateTotalEstimate();
            const totalReduction = originalTotal - currentTotal;
            const reductionPercentage = (totalReduction / targetReduction * 100).toFixed(1);

            // ãƒãƒ³ãƒ‰ãƒ©ãƒ¼é–¢æ•°
            const handleStaffChange = (role, monthIndex, value) => {
                const newStaffPlan = { ...staffPlan };
                newStaffPlan[role][monthIndex] = Math.max(0, parseInt(value) || 0);
                setStaffPlan(newStaffPlan);
            };

            const handleBusyAllowanceChange = (monthIndex, value) => {
                setBusySeasonAllowances(prev => ({
                    ...prev,
                    [monthIndex]: Math.max(0, parseInt(value) || 0)
                }));
            };

            // ãƒ–ãƒ¼ã‚¹æ•°å¤‰æ›´ãƒãƒ³ãƒ‰ãƒ©ãƒ¼
            const handleBoothCountChange = (monthIndex, value) => {
                const newBoothCounts = [...boothCounts];
                newBoothCounts[monthIndex] = Math.max(0, parseInt(value) || 0);
                setBoothCounts(newBoothCounts);
            };

            // æ•°å€¤ãƒ•ã‚©ãƒ¼ãƒãƒƒãƒˆ
            const formatNumber = (num) => {
                return new Intl.NumberFormat('ja-JP').format(num);
            };

            // A4ã‚µãƒãƒªãƒ¼PDFå‡ºåŠ›é–¢æ•°
            const generatePDF = () => {
                const pdfWindow = window.open('', '_blank');
                
                // æœˆåˆ¥ãƒ‡ãƒ¼ã‚¿ã®è¨ˆç®—
                const monthlyData = months.map((month, index) => ({
                    month,
                    amount: calculateMonthlyEstimate(index),
                    originalAmount: originalMonthlyEstimates[index],
                    boothCount: boothCounts[index]
                }));
                
                // æœ€å¤§å€¤ã®è¨ˆç®—ï¼ˆæ£’ã‚°ãƒ©ãƒ•ã®é«˜ã•èª¿æ•´ç”¨ï¼‰
                const maxAmount = Math.max(...monthlyData.map(d => d.amount));
                
                // ãƒªã‚¹ã‚¯è©•ä¾¡ã®è¨ˆç®—
                const riskEvaluation = () => {
                    const baselineStaff = {
                        'MGR': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1],
                        'SV': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1],
                        'LD': [3, 3, 3, 3, 3, 4, 5, 6, 6, 6, 4, 3],
                        'CM': [14, 14, 14, 17, 16, 22, 27, 34, 32, 31, 21, 14]
                    };
                    
                    const totalReductions = Object.entries(staffPlan).map(([role, counts]) => {
                        const totalCurrent = counts.reduce((sum, count) => sum + count, 0);
                        const totalBaseline = baselineStaff[role].reduce((sum, count) => sum + count, 0);
                        const reductionRate = ((totalBaseline - totalCurrent) / totalBaseline * 100);
                        return { role, reductionRate, totalCurrent, totalBaseline };
                    });
                    
                    const hasHighRisk = totalReductions.some(r => r.reductionRate > 25);
                    const hasMediumRisk = totalReductions.some(r => r.reductionRate > 10);
                    
                    return { totalReductions, hasHighRisk, hasMediumRisk };
                };
                
                const { totalReductions, hasHighRisk, hasMediumRisk } = riskEvaluation();
                
                pdfWindow.document.write(`
<!DOCTYPE html>
<html lang="ja">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>è¦‹ç©æ›¸ã‚µãƒãƒªãƒ¼ 2025å¹´åº¦</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }
        
        @page {
            size: A4;
            margin: 15mm;
        }
        
        body {
            font-family: 'Noto Sans JP', 'Hiragino Sans', 'Yu Gothic', 'Meiryo', sans-serif;
            font-size: 12px;
            line-height: 1.4;
            color: #333;
            background: white;
            width: 210mm;
            height: 297mm;
            padding: 15mm;
            margin: 0 auto;
            box-shadow: 0 0 20px rgba(0,0,0,0.1);
        }
        
        .page-header {
            text-align: center;
            border-bottom: 3px solid #2c5282;
            padding-bottom: 15px;
            margin-bottom: 20px;
        }
        
        .page-title {
            font-size: 24px;
            font-weight: 700;
            color: #2c5282;
            margin-bottom: 5px;
        }
        
        .page-subtitle {
            font-size: 14px;
            color: #666;
            margin-bottom: 10px;
        }
        
        .issue-date {
            font-size: 11px;
            color: #999;
        }
        
        .section {
            margin-bottom: 25px;
        }
        
        .section-title {
            font-size: 16px;
            font-weight: 600;
            color: #2c5282;
            margin-bottom: 12px;
            padding-left: 10px;
            border-left: 4px solid #2c5282;
        }
        
        .kpi-grid {
            display: grid;
            grid-template-columns: repeat(4, 1fr);
            gap: 15px;
            margin-bottom: 25px;
        }
        
        .kpi-card {
            background: #f7fafc;
            border: 1px solid #e2e8f0;
            border-radius: 8px;
            padding: 15px;
            text-align: center;
            position: relative;
        }
        
        .kpi-card.primary {
            background: #ebf8ff;
            border-color: #3182ce;
        }
        
        .kpi-card.success {
            background: #f0fff4;
            border-color: #38a169;
        }
        
        .kpi-card.warning {
            background: #fffaf0;
            border-color: #dd6b20;
        }
        
        .kpi-card.danger {
            background: #fed7d7;
            border-color: #e53e3e;
        }
        
        .kpi-label {
            font-size: 11px;
            color: #666;
            margin-bottom: 5px;
            font-weight: 500;
        }
        
        .kpi-value {
            font-size: 20px;
            font-weight: 700;
            color: #2d3748;
            margin-bottom: 3px;
        }
        
        .kpi-change {
            font-size: 10px;
            color: #666;
        }
        
        .monthly-chart {
            background: #f7fafc;
            border-radius: 8px;
            padding: 20px;
            margin-bottom: 25px;
        }
        
        .chart-container {
            display: grid;
            grid-template-columns: repeat(12, 1fr);
            gap: 8px;
            margin-top: 15px;
        }
        
        .month-column {
            text-align: center;
        }
        
        .month-label {
            font-size: 10px;
            color: #666;
            margin-bottom: 5px;
            font-weight: 500;
        }
        
        .month-bar {
            background: #e2e8f0;
            border-radius: 4px;
            position: relative;
            margin-bottom: 5px;
            height: 80px;
            display: flex;
            align-items: flex-end;
        }
        
        .month-bar-fill {
            width: 100%;
            border-radius: 4px;
            background: linear-gradient(to top, #3182ce, #63b3ed);
            transition: all 0.3s ease;
            position: relative;
            min-height: 15px;
        }
        
        .month-bar-fill.peak {
            background: linear-gradient(to top, #e53e3e, #fc8181);
        }
        
        .month-value {
            font-size: 9px;
            color: #2d3748;
            font-weight: 600;
            writing-mode: vertical-lr;
            text-orientation: mixed;
            position: absolute;
            top: -15px;
            left: 50%;
            transform: translateX(-50%);
        }
        
        .risk-grid {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 20px;
        }
        
        .risk-category {
            background: #f7fafc;
            border-radius: 8px;
            padding: 15px;
            border-left: 4px solid #718096;
        }
        
        .risk-category.high {
            border-left-color: #e53e3e;
            background: #fed7d7;
        }
        
        .risk-category.medium {
            border-left-color: #dd6b20;
            background: #fef5e7;
        }
        
        .risk-category.low {
            border-left-color: #38a169;
            background: #f0fff4;
        }
        
        .risk-title {
            font-size: 13px;
            font-weight: 600;
            color: #2d3748;
            margin-bottom: 8px;
        }
        
        .risk-item {
            font-size: 11px;
            color: #4a5568;
            margin-bottom: 4px;
            padding-left: 8px;
            position: relative;
        }
        
        .risk-item::before {
            content: 'â€¢';
            position: absolute;
            left: 0;
            color: #a0aec0;
        }
        
        .summary-box {
            background: #2c5282;
            color: white;
            border-radius: 8px;
            padding: 15px;
            text-align: center;
            margin-top: 20px;
        }
        
        .summary-title {
            font-size: 14px;
            font-weight: 600;
            margin-bottom: 10px;
        }
        
        .summary-content {
            font-size: 11px;
            line-height: 1.5;
        }
        
        .legend {
            display: flex;
            justify-content: center;
            gap: 20px;
            margin-top: 10px;
            font-size: 10px;
        }
        
        .legend-item {
            display: flex;
            align-items: center;
            gap: 5px;
        }
        
        .legend-color {
            width: 12px;
            height: 12px;
            border-radius: 2px;
        }
        
        @media print {
            body {
                box-shadow: none;
                width: auto;
                height: auto;
                padding: 0;
                margin: 0;
            }
        }
    </style>
</head>
<body>
    <div class="page-header">
        <div class="page-title">ã‚µãƒãƒ¼ãƒˆæ¥­å‹™è¦‹ç©ã‚µãƒãƒªãƒ¼</div>
        <div class="page-subtitle">2025å¹´åº¦ï¼ˆ2025å¹´7æœˆ - 2026å¹´6æœˆï¼‰</div>
        <div class="issue-date">ç™ºè¡Œæ—¥: ${new Date().toLocaleDateString('ja-JP')}</div>
    </div>
    
    <div class="section">
        <div class="section-title">ğŸ“Š è¦‹ç©æ¦‚è¦</div>
        <div class="kpi-grid">
            <div class="kpi-card primary">
                <div class="kpi-label">ç¾åœ¨ã®è¦‹ç©é¡</div>
                <div class="kpi-value">Â¥${(currentTotal / 1000000).toFixed(1)}M</div>
                <div class="kpi-change">å¹´é–“ç·é¡</div>
            </div>
            <div class="kpi-card ${totalReduction > 0 ? 'success' : 'danger'}">
                <div class="kpi-label">å‰Šæ¸›é¡</div>
                <div class="kpi-value">Â¥${(totalReduction / 1000000).toFixed(1)}M</div>
                <div class="kpi-change">${totalReduction > 0 ? 'å‰Šæ¸›é”æˆ' : 'å‰Šæ¸›ãªã—'}</div>
            </div>
            <div class="kpi-card ${reductionPercentage >= 100 ? 'success' : parseFloat(reductionPercentage) > 50 ? 'warning' : 'danger'}">
                <div class="kpi-label">ç›®æ¨™é”æˆç‡</div>
                <div class="kpi-value">${reductionPercentage}%</div>
                <div class="kpi-change">${reductionPercentage >= 100 ? 'é”æˆ' : 'æœªé”æˆ'}</div>
            </div>
            <div class="kpi-card danger">
                <div class="kpi-label">ç›®æ¨™å‰Šæ¸›é¡</div>
                <div class="kpi-value">Â¥${(targetReduction / 1000000).toFixed(1)}M</div>
                <div class="kpi-change">è¦å‰Šæ¸›</div>
            </div>
        </div>
    </div>
    
    <div class="section">
        <div class="section-title">ğŸ“ˆ æœˆåˆ¥è¦‹ç©æ¨ç§»</div>
        <div class="monthly-chart">
            <div style="display: flex; justify-content: space-between; align-items: center; margin-bottom: 10px;">
                <span style="font-size: 13px; font-weight: 600;">æœˆåˆ¥ã‚³ã‚¹ãƒˆï¼ˆç™¾ä¸‡å††ï¼‰</span>
                <span style="font-size: 11px; color: #666;">æœ€å¤§: ${(maxAmount / 1000000).toFixed(1)}M</span>
            </div>
            <div class="chart-container">
                ${monthlyData.map((data, index) => {
                    const height = (data.amount / maxAmount * 100);
                    const isPeak = index >= 6 && index <= 10; // 1æœˆ-5æœˆ
                    const amountInM = (data.amount / 1000000).toFixed(1);
                    
                    return `
                    <div class="month-column">
                        <div class="month-label">${data.month}</div>
                        <div class="month-bar">
                            <div class="month-bar-fill ${isPeak ? 'peak' : ''}" style="height: ${height}%;">
                                <div class="month-value">${amountInM}</div>
                            </div>
                        </div>
                    </div>
                    `;
                }).join('')}
            </div>
            <div class="legend">
                <div class="legend-item">
                    <div class="legend-color" style="background: linear-gradient(to top, #3182ce, #63b3ed);"></div>
                    <span>é€šå¸¸æœŸ</span>
                </div>
                <div class="legend-item">
                    <div class="legend-color" style="background: linear-gradient(to top, #e53e3e, #fc8181);"></div>
                    <span>ç¹å¿™æœŸï¼ˆæ‰‹å½“è¾¼ã¿ï¼‰</span>
                </div>
            </div>
        </div>
    </div>
    
    <div class="section">
        <div class="section-title">âš ï¸ ãƒªã‚¹ã‚¯è©•ä¾¡</div>
        <div class="risk-grid">
            <div class="risk-category ${hasHighRisk ? 'high' : hasMediumRisk ? 'medium' : 'low'}">
                <div class="risk-title">${hasHighRisk ? 'ğŸ”´ é«˜ãƒªã‚¹ã‚¯' : hasMediumRisk ? 'ğŸŸ¡ ä¸­ãƒªã‚¹ã‚¯' : 'ğŸŸ¢ ä½ãƒªã‚¹ã‚¯'}</div>
                ${totalReductions.filter(r => r.reductionRate > 0).map(r => 
                    `<div class="risk-item">${r.role}: ${r.reductionRate.toFixed(1)}%å‰Šæ¸› (${r.totalCurrent}/${r.totalBaseline}å)</div>`
                ).join('')}
                ${totalReductions.filter(r => r.reductionRate > 0).length === 0 ? 
                    '<div class="risk-item">äººå“¡å‰Šæ¸›ãªã— - é©æ­£é…ç½®</div>' : ''}
            </div>
            <div class="risk-category medium">
                <div class="risk-title">ğŸŸ¡ é‹ç”¨ãƒªã‚¹ã‚¯</div>
                <div class="risk-item">ç¹å¿™æœŸæ‰‹å½“: Â¥${formatNumber(
                    Object.keys(busySeasonHours).reduce((total, monthIndex) => {
                        const hours = busySeasonHours[monthIndex] || 0;
                        const allowance = busySeasonAllowances[monthIndex] || 0;
                        return total + (hours * allowance);
                    }, 0)
                )}</div>
                <div class="risk-item">æœ€å¤§ãƒ–ãƒ¼ã‚¹æ•°: ${Math.max(...boothCounts)}ãƒ–ãƒ¼ã‚¹</div>
                <div class="risk-item">æœˆé–“å¤‰å‹•ç‡: ${((maxAmount / Math.min(...monthlyData.map(d => d.amount))) * 100 - 100).toFixed(0)}%</div>
            </div>
            <div class="risk-category low">
                <div class="risk-title">ğŸŸ¢ å®‰å®šè¦ç´ </div>
                <div class="risk-item">ç®¡ç†ä½“åˆ¶: MGRãƒ»SVç¢ºä¿</div>
                <div class="risk-item">åŸºæœ¬å˜ä¾¡: æ®ãˆç½®ã</div>
                <div class="risk-item">é€šä¿¡ã‚¤ãƒ³ãƒ•ãƒ©: å®‰å®š</div>
            </div>
            <div class="risk-category medium">
                <div class="risk-title">ğŸ’¡ æ”¹å–„ææ¡ˆ</div>
                <div class="risk-item">ç¹å¿™æœŸã®äººå“¡é…ç½®æœ€é©åŒ–</div>
                <div class="risk-item">AIãƒ»è‡ªå‹•åŒ–ã«ã‚ˆã‚‹åŠ¹ç‡åŒ–</div>
                <div class="risk-item">æ®µéšçš„ã‚³ã‚¹ãƒˆå‰Šæ¸›è¨ˆç”»</div>
                <div class="risk-item">ãƒ–ãƒ¼ã‚¹åˆ©ç”¨ç‡ã®æœ€é©åŒ–</div>
            </div>
        </div>
    </div>
    
    <div class="summary-box">
        <div class="summary-title">ç·åˆè©•ä¾¡</div>
        <div class="summary-content">
            ç¾åœ¨ã®è¦‹ç©é¡Â¥${(currentTotal / 1000000).toFixed(1)}Mã¯${totalReduction >= 0 ? `åŸæ¡ˆã‹ã‚‰Â¥${(totalReduction / 1000000).toFixed(1)}Må‰Šæ¸›` : `åŸæ¡ˆã‚’Â¥${(Math.abs(totalReduction) / 1000000).toFixed(1)}Mè¶…é`}ã—ã¦ã„ã¾ã™ã€‚<br>
            ${totalReduction >= targetReduction 
                ? `ç›®æ¨™å‰Šæ¸›é¡ã‚’é”æˆã—ã€è¿½åŠ ã§Â¥${((totalReduction - targetReduction) / 1000000).toFixed(1)}Mã®å‰Šæ¸›åŠ¹æœãŒã‚ã‚Šã¾ã™ã€‚` 
                : `ç›®æ¨™é”æˆã¾ã§Â¥${((targetReduction - totalReduction) / 1000000).toFixed(1)}Mã®è¿½åŠ å‰Šæ¸›ãŒå¿…è¦ã§ã™ã€‚`}<br>
            <strong>æ¨å¥¨ã‚¢ã‚¯ã‚·ãƒ§ãƒ³:</strong> ${hasHighRisk ? 'æ®µéšçš„å‰Šæ¸›ã¨ãƒªã‚¹ã‚¯è»½æ¸›ç­–ã®å®Ÿæ–½' : hasMediumRisk ? 'å“è³ªãƒ¢ãƒ‹ã‚¿ãƒªãƒ³ã‚°å¼·åŒ–' : 'ç¾è¡Œãƒ—ãƒ©ãƒ³ã§ã®å®Ÿè¡Œå¯èƒ½'}</div>
    </div>
</body>
</html>
                `);
                
                pdfWindow.document.close();
                
                // PDFãƒ€ã‚¤ã‚¢ãƒ­ã‚°ã‚’è‡ªå‹•ã§é–‹ã
                setTimeout(() => {
                    pdfWindow.print();
                }, 500);
            };

            // ãƒªã‚¹ã‚¯è©•ä¾¡é–¢æ•°
            const getRiskLevel = (rate) => {
                if (rate <= 0) return { level: 'ãªã—', color: 'bg-green-100 text-green-800 border-green-200', icon: 'âœ…' };
                if (rate <= 10) return { level: 'ä½', color: 'bg-yellow-100 text-yellow-800 border-yellow-200', icon: 'âš ï¸' };
                if (rate <= 25) return { level: 'ä¸­', color: 'bg-orange-100 text-orange-800 border-orange-200', icon: 'âš¡' };
                return { level: 'é«˜', color: 'bg-red-100 text-red-800 border-red-200', icon: 'ğŸš¨' };
            };

            const getRiskContent = (role, rate) => {
                if (rate <= 0) return ['ãƒªã‚¹ã‚¯ãªã— - é©æ­£ãªäººå“¡é…ç½®ã§ã™'];
                
                const riskMap = {
                    'MGR': [
                        'â€¢ æˆ¦ç•¥ç­–å®šãƒ»æ–¹é‡æ±ºå®šã®é…å»¶',
                        'â€¢ KPIç®¡ç†ãƒ»é€²æ—ç¢ºèªã®ä¸å‚™',
                        'â€¢ å¥‘ç´„äº¤æ¸‰ãƒ»å–¶æ¥­å¯¾å¿œã®æ”¯éšœ',
                        'â€¢ ãƒãƒ¼ãƒ çµ±åˆ¶ãƒ»äººäº‹ç®¡ç†ã®ãƒªã‚¹ã‚¯'
                    ],
                    'SV': [
                        'â€¢ ç¾å ´ãƒãƒã‚¸ãƒ¡ãƒ³ãƒˆä¸è¶³',
                        'â€¢ LDãƒ»CMè‚²æˆãƒ—ãƒ©ãƒ³ã®é…å»¶',
                        'â€¢ é‡è¦æ¡ˆä»¶ãƒ»å€‹åˆ¥ç›¸è«‡å¯¾å¿œã®æ”¯éšœ',
                        'â€¢ å“è³ªç®¡ç†ãƒ»å ±å‘Šæ¥­å‹™ã®ä¸å‚™'
                    ],
                    'LD': [
                        'â€¢ CMãƒ•ã‚©ãƒ­ãƒ¼ãƒ»æŒ‡å°ä¸è¶³',
                        'â€¢ KPIç®¡ç†ï¼ˆ1on1ã€FBï¼‰ã®é »åº¦ä½ä¸‹',
                        'â€¢ æ–°äººè‚²æˆãƒ»OJTã®è³ªä½ä¸‹',
                        'â€¢ ã‚¨ã‚¹ã‚«ãƒ¬ãƒ¼ã‚·ãƒ§ãƒ³å¯¾å¿œé…å»¶'
                    ],
                    'CM': [
                        'â€¢ ã‚³ãƒ¼ãƒ«ãƒ»ãƒ¡ãƒ¼ãƒ«å¿œç­”ç‡ã®ä½ä¸‹',
                        'â€¢ é¡§å®¢å¾…ã¡æ™‚é–“ã®å¢—åŠ ',
                        'â€¢ ä¸€æ¬¡å¯¾å¿œå“è³ªã®ä½ä¸‹',
                        'â€¢ é¡§å®¢æº€è¶³åº¦ã¸ã®å½±éŸ¿'
                    ]
                };
                
                return riskMap[role] || ['â€¢ æ¥­å‹™å“è³ªã¸ã®å½±éŸ¿'];
            };

            const roleDisplayNames = {
                'MGR': 'MGRï¼1å¼',
                'SV': 'SVï¼B',
                'LD': 'LDï¼B',
                'CM': 'CMï¼B'
            };

            return (
                <div className="min-h-screen bg-gradient-to-br from-blue-50 via-white to-purple-50 p-6">
                    <div className="max-w-7xl mx-auto">
                        {/* ãƒ˜ãƒƒãƒ€ãƒ¼ */}
                        <div className="bg-white rounded-2xl shadow-xl p-6 mb-6 border border-gray-100">
                            <h1 className="text-3xl font-bold text-gray-800 mb-4">ğŸ“Š è¦‹ç©ã‚‚ã‚Šã‚·ãƒŸãƒ¥ãƒ¬ãƒ¼ã‚¿ãƒ¼</h1>
                            
                            {/* ã‚µãƒãƒªãƒ¼ */}
                            <div className="grid grid-cols-1 md:grid-cols-4 gap-4">
                                <div className="bg-gradient-to-r from-blue-500 to-blue-600 text-white p-4 rounded-xl">
                                    <div className="text-sm opacity-90 mb-1">ğŸ“ˆ ç¾åœ¨ã®è¦‹ç©é¡</div>
                                    <div className="text-2xl font-bold">Â¥{formatNumber(currentTotal)}</div>
                                </div>
                                
                                <div className="bg-gradient-to-r from-green-500 to-green-600 text-white p-4 rounded-xl">
                                    <div className="text-sm opacity-90 mb-1">ğŸ“‰ å‰Šæ¸›é¡</div>
                                    <div className="text-2xl font-bold">Â¥{formatNumber(totalReduction)}</div>
                                </div>
                                
                                <div className="bg-gradient-to-r from-purple-500 to-purple-600 text-white p-4 rounded-xl">
                                    <div className="text-sm opacity-90 mb-1">ğŸ¯ ç›®æ¨™é”æˆç‡</div>
                                    <div className="text-2xl font-bold">{reductionPercentage}%</div>
                                </div>
                                
                                <div className="bg-gradient-to-r from-orange-500 to-orange-600 text-white p-4 rounded-xl">
                                    <div className="text-sm opacity-90 mb-1">ğŸ¯ ç›®æ¨™å‰Šæ¸›é¡</div>
                                    <div className="text-2xl font-bold">Â¥{formatNumber(targetReduction)}</div>
                                </div>
                            </div>
                        </div>

                        {/* ç¹å¿™æœŸæ‰‹å½“è¨­å®š */}
                        <div className="bg-white rounded-2xl shadow-xl p-6 mb-6 border border-gray-100">
                            <h2 className="text-2xl font-bold text-gray-800 mb-4">ğŸ¯ ç¹å¿™æœŸæ‰‹å½“è¨­å®šï¼ˆæœˆåˆ¥ï¼‰</h2>
                            
                            {/* æœˆåˆ¥è¨­å®šã‚°ãƒªãƒƒãƒ‰ */}
                            <div className="grid grid-cols-1 md:grid-cols-3 lg:grid-cols-4 gap-4">
                                {months.map((month, index) => {
                                    const hours = busySeasonHours[index] || 0;
                                    const allowance = busySeasonAllowances[index] || 0;
                                    const totalAmount = hours * allowance;
                                    const isActive = hours > 0;
                                    
                                    return (
                                        <div key={index} className={`p-4 rounded-xl border-2 ${
                                            isActive ? 'bg-orange-50 border-orange-200' : 'bg-gray-50 border-gray-200'
                                        }`}>
                                            <div className="text-center mb-2">
                                                <div className="font-bold text-lg">{month}</div>
                                                {isActive && (
                                                    <div className="text-xs text-gray-600">{formatNumber(hours)}æ™‚é–“</div>
                                                )}
                                            </div>
                                            
                                            <div className="space-y-2">
                                                <label className="block text-xs font-semibold text-gray-700">
                                                    å˜ä¾¡ï¼ˆå††/æ™‚é–“ï¼‰
                                                </label>
                                                <input
                                                    type="number"
                                                    value={allowance}
                                                    onChange={(e) => handleBusyAllowanceChange(index, e.target.value)}
                                                    className="w-full p-2 text-sm border rounded"
                                                    min="0"
                                                    placeholder="0"
                                                    disabled={!isActive}
                                                />
                                                
                                                {isActive && (
                                                    <div className="text-center">
                                                        <div className="text-xs text-gray-600">æœˆé¡</div>
                                                        <div className="font-bold text-sm text-orange-700">
                                                            Â¥{formatNumber(totalAmount)}
                                                        </div>
                                                    </div>
                                                )}
                                            </div>
                                        </div>
                                    );
                                })}
                            </div>
                            
                            {/* åˆè¨ˆè¡¨ç¤º */}
                            <div className="mt-4 p-3 bg-blue-50 rounded-lg">
                                <div className="text-sm font-semibold text-gray-700 mb-2">ğŸ“Š ç¹å¿™æœŸæ‰‹å½“åˆè¨ˆ</div>
                                <div className="text-lg font-bold text-blue-700">
                                    å¹´é–“åˆè¨ˆ: Â¥{formatNumber(
                                        Object.keys(busySeasonHours).reduce((total, monthIndex) => {
                                            const hours = busySeasonHours[monthIndex] || 0;
                                            const allowance = busySeasonAllowances[monthIndex] || 0;
                                            return total + (hours * allowance);
                                        }, 0)
                                    )}
                                </div>
                            </div>
                        </div>

                        {/* æœˆåˆ¥è©³ç´°ãƒ†ãƒ¼ãƒ–ãƒ« */}
                        <div className="bg-white rounded-2xl shadow-xl p-6 mb-6 border border-gray-100">
                            <h2 className="text-2xl font-bold text-gray-800 mb-4">æœˆåˆ¥è¦‹ç©è©³ç´°</h2>
                            <div className="overflow-x-auto">
                                <table className="w-full text-sm">
                                    <thead>
                                        <tr className="bg-gray-50">
                                            <th className="text-left p-3 font-semibold border-b">é …ç›®</th>
                                            {months.map((month, index) => (
                                                <th key={index} className="text-center p-3 font-semibold border-b min-w-20">{month}</th>
                                            ))}
                                        </tr>
                                    </thead>
                                    <tbody>
                                        <tr>
                                            <td className="p-3 font-medium bg-blue-50">å–¶æ¥­æ—¥æ•°</td>
                                            {businessDays.map((days, index) => (
                                                <td key={index} className="text-center p-3 border-b">{days}</td>
                                            ))}
                                        </tr>
                                        
                                        {/* ç¹å¿™æœŸæ‰‹å½“é©ç”¨çŠ¶æ³ */}
                                        <tr>
                                            <td className="p-3 font-medium bg-orange-50">ç¹å¿™æœŸæ‰‹å½“</td>
                                            {months.map((_, index) => {
                                                const allowance = busySeasonAllowances[index] || 0;
                                                const hours = busySeasonHours[index] || 0;
                                                const totalAmount = hours * allowance;
                                                const isActive = hours > 0;
                                                
                                                return (
                                                    <td key={index} className="text-center p-2 border-b">
                                                        {isActive ? (
                                                            <div className="text-xs">
                                                                <div className={`px-1 py-1 rounded ${
                                                                    allowance > 0 
                                                                        ? 'bg-orange-200 text-orange-800 font-bold' 
                                                                        : 'bg-gray-100 text-gray-500'
                                                                }`}>
                                                                    Â¥{allowance}/h
                                                                </div>
                                                                <div className="text-gray-600 mt-1">
                                                                    Â¥{formatNumber(totalAmount)}
                                                                </div>
                                                            </div>
                                                        ) : (
                                                            <span className="px-2 py-1 rounded text-xs bg-gray-100 text-gray-500">
                                                                -
                                                            </span>
                                                        )}
                                                    </td>
                                                );
                                            })}
                                        </tr>
                                        
                                        {/* äººå“¡è¨ˆç”» */}
                                        {Object.entries(staffPlan).map(([role, counts]) => {
                                            const defaultStaff = {
                                                'MGR': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1],
                                                'SV': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1],
                                                'LD': [3, 3, 3, 3, 3, 4, 5, 6, 6, 6, 4, 3],
                                                'CM': [14, 14, 14, 17, 16, 22, 27, 34, 32, 31, 21, 14]
                                            };
                                            
                                            return (
                                                <tr key={role}>
                                                    <td className="p-3 font-medium bg-yellow-50">{roleDisplayNames[role]}</td>
                                                    {counts.map((count, index) => (
                                                        <td key={index} className="text-center p-2 border-b">
                                                            <div className="flex flex-col items-center">
                                                                <input
                                                                    type="number"
                                                                    value={count}
                                                                    onChange={(e) => handleStaffChange(role, index, e.target.value)}
                                                                    className="w-12 text-center border rounded px-1 py-1 text-sm"
                                                                    min="0"
                                                                />
                                                                <span className="text-xs text-gray-400 mt-1">({defaultStaff[role][index]})</span>
                                                            </div>
                                                        </td>
                                                    ))}
                                                </tr>
                                            );
                                        })}
                                        
                                        {/* ãƒ–ãƒ¼ã‚¹æ•° */}
                                        <tr>
                                            <td className="p-3 font-medium bg-blue-50">ãƒ–ãƒ¼ã‚¹æ•°</td>
                                            {boothCounts.map((count, index) => (
                                                <td key={index} className="text-center p-2 border-b">
                                                    <div className="flex flex-col items-center">
                                                        <input
                                                            type="number"
                                                            value={count}
                                                            onChange={(e) => handleBoothCountChange(index, e.target.value)}
                                                            className="w-12 text-center border rounded px-1 py-1 text-sm"
                                                            min="0"
                                                        />
                                                        <span className="text-xs text-gray-400 mt-1">({defaultBoothCounts[index]}B)</span>
                                                    </div>
                                                </td>
                                            ))}
                                        </tr>
                                        
                                        {/* ãƒ–ãƒ¼ã‚¹åˆ©ç”¨æ–™ */}
                                        <tr>
                                            <td className="p-3 font-medium bg-blue-50">ãƒ–ãƒ¼ã‚¹åˆ©ç”¨æ–™</td>
                                            {boothCounts.map((count, index) => {
                                                const monthlyBoothCost = count * boothUnitPrice;
                                                const baselineBoothCost = defaultBoothCounts[index] * boothUnitPrice;
                                                const boothCostDiff = monthlyBoothCost - baselineBoothCost;
                                                return (
                                                    <td key={index} className="text-center p-2 border-b">
                                                        <div className="text-xs">
                                                            <div className="font-bold">Â¥{formatNumber(monthlyBoothCost)}</div>
                                                            {Math.abs(boothCostDiff) > 0 && (
                                                                <div className={`text-xs ${boothCostDiff > 0 ? 'text-red-600' : 'text-green-600'}`}>
                                                                    {boothCostDiff > 0 ? 'â†‘' : 'â†“'}Â¥{formatNumber(Math.abs(boothCostDiff))}
                                                                </div>
                                                            )}
                                                        </div>
                                                    </td>
                                                );
                                            })}
                                        </tr>
                                        
                                        {/* æœˆåˆ¥è¦‹ç©é¡ */}
                                        <tr className="bg-purple-50">
                                            <td className="p-3 font-bold">æœˆåˆ¥è¦‹ç©é¡</td>
                                            {months.map((_, index) => {
                                                const monthlyAmount = calculateMonthlyEstimate(index);
                                                const originalAmount = originalMonthlyEstimates[index];
                                                const reduction = originalAmount - monthlyAmount;
                                                return (
                                                    <td key={index} className="text-center p-3 border-b">
                                                        <div className="text-sm font-bold">Â¥{formatNumber(monthlyAmount)}</div>
                                                        {Math.abs(reduction) > 100 && (
                                                            <div className={`text-xs ${reduction > 0 ? 'text-green-600' : 'text-red-600'}`}>
                                                                {reduction > 0 ? 'â†“' : 'â†‘'}Â¥{formatNumber(Math.abs(reduction))}
                                                            </div>
                                                        )}
                                                    </td>
                                                );
                                            })}
                                        </tr>
                                    </tbody>
                                </table>
                            </div>
                        </div>

                        {/* ãƒªã‚¹ã‚¯è©•ä¾¡ãƒœãƒƒã‚¯ã‚¹ */}
                        <div className="bg-white rounded-2xl shadow-xl p-6 border border-gray-100">
                            <h2 className="text-2xl font-bold text-gray-800 mb-4">äººå“¡å‰Šæ¸›ãƒªã‚¹ã‚¯è©•ä¾¡</h2>
                            <div className="grid grid-cols-1 md:grid-cols-2 gap-6">
                                {Object.entries(staffPlan).map(([role, counts]) => {
                                    const baselineStaff = {
                                        'MGR': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1],
                                        'SV': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1],
                                        'LD': [3, 3, 3, 3, 3, 4, 5, 6, 6, 6, 4, 3],
                                        'CM': [14, 14, 14, 17, 16, 22, 27, 34, 32, 31, 21, 14]
                                    };
                                    
                                    const totalCurrent = counts.reduce((sum, count) => sum + count, 0);
                                    const totalBaseline = baselineStaff[role].reduce((sum, count) => sum + count, 0);
                                    const reductionRate = ((totalBaseline - totalCurrent) / totalBaseline * 100);
                                    
                                    const risk = getRiskLevel(reductionRate);
                                    const riskContent = getRiskContent(role, reductionRate);

                                    return (
                                        <div key={role} className={`border-2 rounded-xl p-4 ${risk.color}`}>
                                            <div className="flex items-center justify-between mb-3">
                                                <div className="flex items-center gap-2">
                                                    <span className="text-lg">{risk.icon}</span>
                                                    <h3 className="font-bold text-lg">{roleDisplayNames[role]}</h3>
                                                </div>
                                                <div className="text-right">
                                                    <div className="text-sm opacity-75">å‰Šæ¸›ç‡</div>
                                                    <div className="font-bold">{reductionRate > 0 ? `${reductionRate.toFixed(1)}%` : '0%'}</div>
                                                </div>
                                            </div>
                                            
                                            <div className="mb-2">
                                                <div className="text-sm font-semibold mb-1">ãƒªã‚¹ã‚¯ãƒ¬ãƒ™ãƒ«: {risk.level}</div>
                                            </div>
                                            
                                            {reductionRate > 0 && (
                                                <div className="text-sm space-y-1">
                                                    <div className="font-semibold">æƒ³å®šã•ã‚Œã‚‹å½±éŸ¿:</div>
                                                    {riskContent.map((content, index) => (
                                                        <div key={index} className="text-xs">{content}</div>
                                                    ))}
                                                </div>
                                            )}
                                            
                                            <div className="mt-2 text-xs opacity-75">
                                                ç¾åœ¨: {totalCurrent}å / åŸºæº–: {totalBaseline}å
                                            </div>
                                        </div>
                                    );
                                })}
                            </div>
                            
                            {/* ç·åˆãƒªã‚¹ã‚¯è©•ä¾¡ */}
                            <div className="mt-6 p-4 bg-gray-50 rounded-xl">
                                <h3 className="font-bold text-lg mb-2">ğŸ¯ ç·åˆãƒªã‚¹ã‚¯è©•ä¾¡</h3>
                                <div className="text-sm space-y-2">
                                    {(() => {
                                        const totalReductions = Object.entries(staffPlan).map(([role, counts]) => {
                                            const baselineStaff = {
                                                'MGR': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1],
                                                'SV': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1],
                                                'LD': [3, 3, 3, 3, 3, 4, 5, 6, 6, 6, 4, 3],
                                                'CM': [14, 14, 14, 17, 16, 22, 27, 34, 32, 31, 21, 14]
                                            };
                                            const totalCurrent = counts.reduce((sum, count) => sum + count, 0);
                                            const totalBaseline = baselineStaff[role].reduce((sum, count) => sum + count, 0);
                                            return { role, reduction: totalBaseline - totalCurrent };
                                        });
                                        
                                        const hasHighRisk = totalReductions.some(r => (r.reduction / (r.role === 'CM' ? 256 : r.role === 'LD' ? 49 : 12)) > 0.25);
                                        const hasMediumRisk = totalReductions.some(r => (r.reduction / (r.role === 'CM' ? 256 : r.role === 'LD' ? 49 : 12)) > 0.1);
                                        
                                        if (hasHighRisk) {
                                            return (
                                                <div>
                                                    <div className="text-red-700 font-semibold">ğŸš¨ é«˜ãƒªã‚¹ã‚¯: ã‚µãƒ¼ãƒ“ã‚¹å“è³ªã¸ã®é‡å¤§ãªå½±éŸ¿ãŒæ‡¸å¿µã•ã‚Œã¾ã™</div>
                                                    <div className="text-sm">â€¢ é¡§å®¢æº€è¶³åº¦ä½ä¸‹ã€SLAæœªé”æˆã€å“è³ªã‚¯ãƒ¬ãƒ¼ãƒ å¢—åŠ ã®å¯èƒ½æ€§</div>
                                                    <div className="text-sm">â€¢ æ®µéšçš„å‰Šæ¸›ã‚„ãƒ—ãƒ­ã‚»ã‚¹æ”¹å–„ã¨ã®ä½µç”¨ã‚’æ¨å¥¨</div>
                                                </div>
                                            );
                                        }
                                        if (hasMediumRisk) {
                                            return (
                                                <div>
                                                    <div className="text-orange-700 font-semibold">âš¡ ä¸­ãƒªã‚¹ã‚¯: æ¥­å‹™å“è³ªã¸ã®å½±éŸ¿ã«æ³¨æ„ãŒå¿…è¦ã§ã™</div>
                                                    <div className="text-sm">â€¢ å¯†æ¥ãªãƒ¢ãƒ‹ã‚¿ãƒªãƒ³ã‚°ã¨å“è³ªç®¡ç†ã®å¼·åŒ–ãŒå¿…è¦</div>
                                                    <div className="text-sm">â€¢ ç ”ä¿®ãƒ»åŠ¹ç‡åŒ–æ–½ç­–ã¨ã®ä¸¦è¡Œå®Ÿæ–½ã‚’æ¨å¥¨</div>
                                                </div>
                                            );
                                        }
                                        return (
                                            <div>
                                                <div className="text-green-700 font-semibold">âœ… ä½ãƒªã‚¹ã‚¯: é©æ­£ãªäººå“¡é…ç½®ç¯„å›²å†…ã§ã™</div>
                                                <div className="text-sm">â€¢ ã‚µãƒ¼ãƒ“ã‚¹å“è³ªã‚’ç¶­æŒã—ãªãŒã‚‰ã‚³ã‚¹ãƒˆå‰Šæ¸›ãŒå¯èƒ½</div>
                                            </div>
                                        );
                                    })()}
                                </div>
                            </div>
                        </div>

                        {/* å‰Šæ¸›åŠ¹æœãƒ¡ãƒƒã‚»ãƒ¼ã‚¸ã¨PDFå‡ºåŠ› */}
                        <div className="mt-6 text-center space-y-4">
                            <div className={`inline-block px-6 py-3 rounded-full text-white font-bold ${
                                totalReduction >= targetReduction ? 'bg-green-500' : 'bg-orange-500'
                            }`}>
                                {totalReduction >= targetReduction 
                                    ? `ğŸ‰ ç›®æ¨™é”æˆï¼ Â¥${formatNumber(totalReduction - targetReduction)}ã®è¿½åŠ å‰Šæ¸›åŠ¹æœ` 
                                    : `ç›®æ¨™ã¾ã§ Â¥${formatNumber(targetReduction - totalReduction)} ã®å‰Šæ¸›ãŒå¿…è¦`
                                }
                            </div>
                            
                            {/* PDFå‡ºåŠ›ãƒœã‚¿ãƒ³ */}
                            <div>
                                <button
                                    onClick={generatePDF}
                                    className="bg-blue-600 hover:bg-blue-700 text-white font-bold py-3 px-6 rounded-lg shadow-lg transition-colors duration-200 flex items-center gap-2 mx-auto"
                                >
                                    <svg className="w-5 h-5" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                        <path strokeLinecap="round" strokeLinejoin="round" strokeWidth={2} d="M12 10v6m0 0l-3-3m3 3l3-3m2 8H7a2 2 0 01-2-2V5a2 2 0 012-2h5.586a1 1 0 01.707.293l5.414 5.414a1 1 0 01.293.707V19a2 2 0 01-2 2z" />
                                    </svg>
                                    ğŸ“„ A4ã‚µãƒãƒªãƒ¼å‡ºåŠ›
                                </button>
                            </div>
                        </div>
                    </div>
                </div>
            );
        }

        // Reactã‚¢ãƒ—ãƒªã‚’ãƒã‚¦ãƒ³ãƒˆ
        const rootElement = document.getElementById('root');
        if (rootElement) {
            ReactDOM.render(React.createElement(EstimateSimulator), rootElement);
        }
    </script>
</body>
</html>
